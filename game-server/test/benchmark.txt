服务器配置
2核CPU 2G内存 100G磁盘 4M带宽

ab -c 1000 -t 10 http://106.3.38.35:8080/
ab -n 10000 -c 1000 http://106.3.38.35:8080/
cat /proc/sys/fs/file-max 188712
ulimit -n 388712 2000
ulimit -n 588712 3000

Benchmarking 106.3.38.35 (be patient)
Completed 5000 requests
Completed 10000 requests
Completed 15000 requests
Completed 20000 requests
Completed 25000 requests
Completed 30000 requests
Completed 35000 requests
Completed 40000 requests
Completed 45000 requests
Finished 45516 requests


Server Software:        
Server Hostname:        106.3.38.35
Server Port:            8080

Document Path:          /
Document Length:        12 bytes

Concurrency Level:      1000
Time taken for tests:   10.000 seconds
Complete requests:      45516
Failed requests:        0
Write errors:           0
Total transferred:      5143308 bytes
HTML transferred:       546192 bytes
Requests per second:    4551.59 [#/sec] (mean)
Time per request:       219.703 [ms] (mean)
Time per request:       0.220 [ms] (mean, across all concurrent requests)
Transfer rate:          502.28 [Kbytes/sec] received

Connection Times (ms)
              min  mean[+/-sd] median   max
Connect:        0  129 550.0      0    7000
Processing:    21   49  31.5     52    2298
Waiting:       20   49  31.5     52    2298
Total:         24  178 553.6     53    7265

Percentage of the requests served within a certain time (ms)
  50%     53
  66%     54
  75%     58
  80%     60
  90%     76
  95%   1055
  98%   1233
  99%   3056
 100%   7265 (longest request)
 
1000/10	1000/30	2000/10	2000/30	3000/30	5000/30
Rps	4551.59	4419.52	4425.09	4714.81	4989.14	4816.55
Tpq	0.220	0.226	0.226	0.212	0.200	0.208
fail	0	0	0	0	0	0

rps:代表每秒处理请求数，并发的主要指标 
tpq:每个请求处理的时间，单位毫秒。 
fail:代表平均处理失败请求数。

ab -c 3000 -t 10 http://106.3.38.35:8080/
This is ApacheBench, Version 2.3 <$Revision: 655654 $>
Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/
Licensed to The Apache Software Foundation, http://www.apache.org/

Benchmarking 106.3.38.35 (be patient)
socket: Too many open files (24)

1000并发
top - 12:23:34 up 1 day, 17:50,  3 users,  load average: 0.08, 0.02, 0.02
Tasks: 107 total,   2 running, 105 sleeping,   0 stopped,   0 zombie
Cpu(s): 46.1%us, 15.5%sy,  0.0%ni, 29.4%id,  0.0%wa,  0.0%hi,  9.0%si,  0.0%st
Mem:   1922552k total,   758428k used,  1164124k free,    53744k buffers
Swap:  2096440k total,        0k used,  2096440k free,   477816k cached

  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND                                                                                         
21126 root      20   0  656m  56m 5484 R 102.5  3.0   0:20.15 node                                                                                           
21488 root      20   0 68240  10m 2072 S 74.9  0.6   0:05.41 ab                                                                                              
21375 mysql     20   0  360m  28m 5624 S  0.3  1.5   0:00.43 mysqld                                                                                          
    1 root      20   0 19228 1476 1188 S  0.0  0.1   0:00.48 init                                                                                            
    2 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kthreadd                                                                                        
    3 root      RT   0     0    0    0 S  0.0  0.0   0:00.10 migration/0                                                                                     
    4 root      20   0     0    0    0 S  0.0  0.0   0:00.34 ksoftirqd/0                                                                                     
    5 root      RT   0     0    0    0 S  0.0  0.0   0:00.00 migration/0                                                                                     
    6 root      RT   0     0    0    0 S  0.0  0.0   0:00.49 watchdog/0                                                                                      
    7 root      RT   0     0    0    0 S  0.0  0.0   0:00.23 migration/1                                                                                     
    8 root      RT   0     0    0    0 S  0.0  0.0   0:00.00 migration/1                                                                                     
    9 root      20   0     0    0    0 S  0.0  0.0   0:01.79 ksoftirqd/1                                                                                     
   10 root      RT   0     0    0    0 S  0.0  0.0   0:00.41 watchdog/1                                                                                      
   11 root      20   0     0    0    0 S  0.0  0.0   0:11.44 events/0                                                                                        
   12 root      20   0     0    0    0 S  0.0  0.0   0:11.87 events/1                                                                                        
   13 root      20   0     0    0    0 S  0.0  0.0   0:00.00 cgroup                                                                                          
   14 root      20   0     0    0    0 S  0.0  0.0   0:00.00 khelper                                                                                         
   15 root      20   0     0    0    0 S  0.0  0.0   0:00.00 netns                                                                                           
   16 root      20   0     0    0    0 S  0.0  0.0   0:00.00 async/mgr                                                                                       
   17 root      20   0     0    0    0 S  0.0  0.0   0:00.00 pm                                                                                              
   18 root      20   0     0    0    0 S  0.0  0.0   0:00.77 sync_supers                                                                                     
   19 root      20   0     0    0    0 S  0.0  0.0   0:00.99 bdi-default                                                                                     
   20 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kintegrityd/0                                                                                   
   21 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kintegrityd/1                                                                                   
   22 root      20   0     0    0    0 S  0.0  0.0   0:00.53 kblockd/0                                                                                       
   23 root      20   0     0    0    0 S  0.0  0.0   0:00.37 kblockd/1                                                                                       
   24 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kacpid                                                                                          
   25 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kacpi_notify                                                                                    
   26 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kacpi_hotplug                                                                                   
   27 root      20   0     0    0    0 S  0.0  0.0   0:00.00 ata/0                                                                                           
   28 root      20   0     0    0    0 S  0.0  0.0   0:00.00 ata/1                                                                                           
   29 root      20   0     0    0    0 S  0.0  0.0   0:00.00 ata_aux                                                                                         
   30 root      20   0     0    0    0 S  0.0  0.0   0:00.00 ksuspend_usbd                                                                                   
   31 root      20   0     0    0    0 S  0.0  0.0   0:00.00 khubd                                                                                           
   32 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kseriod                                                                                         
   33 root      20   0     0    0    0 S  0.0  0.0   0:00.00 md/0                                                                                            
   34 root      20   0     0    0    0 S  0.0  0.0   0:00.00 md/1                                                                                            
   35 root      20   0     0    0    0 S  0.0  0.0   0:00.00 md_misc/0                                                                                       
   36 root      20   0     0    0    0 S  0.0  0.0   0:00.00 md_misc/1                                                                                       
   37 root      20   0     0    0    0 S  0.0  0.0   0:00.04 khungtaskd                                                                                      
   38 root      20   0     0    0    0 S  0.0  0.0   0:00.06 kswapd0                                                                                         
   39 root      25   5     0    0    0 S  0.0  0.0   0:00.00 ksmd 
   
2000并发
top - 12:36:39 up 1 day, 18:03,  3 users,  load average: 0.10, 0.04, 0.01
Tasks: 107 total,   2 running, 105 sleeping,   0 stopped,   0 zombie
Cpu(s): 49.1%us, 14.6%sy,  0.0%ni, 27.4%id,  0.0%wa,  0.0%hi,  8.9%si,  0.0%st
Mem:   1922552k total,   769244k used,  1153308k free,    53908k buffers
Swap:  2096440k total,        0k used,  2096440k free,   478032k cached

  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND                                                                                         
21499 root      20   0  658m  58m 5492 R 102.5  3.1   0:13.68 node                                                                                           
21565 root      20   0 78528  16m 2072 S 74.5  0.9   0:02.76 ab                                                                                              
    1 root      20   0 19228 1476 1188 S  0.0  0.1   0:00.48 init                                                                                            
    2 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kthreadd                                                                                        
    3 root      RT   0     0    0    0 S  0.0  0.0   0:00.10 migration/0                                                                                     
    4 root      20   0     0    0    0 S  0.0  0.0   0:00.35 ksoftirqd/0                                                                                     
    5 root      RT   0     0    0    0 S  0.0  0.0   0:00.00 migration/0                                                                                     
    6 root      RT   0     0    0    0 S  0.0  0.0   0:00.49 watchdog/0                                                                                      
    7 root      RT   0     0    0    0 S  0.0  0.0   0:00.23 migration/1                                                                                     
    8 root      RT   0     0    0    0 S  0.0  0.0   0:00.00 migration/1                                                                                     
    9 root      20   0     0    0    0 S  0.0  0.0   0:01.79 ksoftirqd/1                                                                                     
   10 root      RT   0     0    0    0 S  0.0  0.0   0:00.42 watchdog/1                                                                                      
   11 root      20   0     0    0    0 S  0.0  0.0   0:11.51 events/0                                                                                        
   12 root      20   0     0    0    0 S  0.0  0.0   0:12.02 events/1                                                                                        
   13 root      20   0     0    0    0 S  0.0  0.0   0:00.00 cgroup                                                                                          
   14 root      20   0     0    0    0 S  0.0  0.0   0:00.00 khelper                                                                                         
   15 root      20   0     0    0    0 S  0.0  0.0   0:00.00 netns                                                                                           
   16 root      20   0     0    0    0 S  0.0  0.0   0:00.00 async/mgr                                                                                       
   17 root      20   0     0    0    0 S  0.0  0.0   0:00.00 pm                                                                                              
   18 root      20   0     0    0    0 S  0.0  0.0   0:00.78 sync_supers                                                                                     
   19 root      20   0     0    0    0 S  0.0  0.0   0:00.99 bdi-default                                                                                     
   20 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kintegrityd/0                                                                                   
   21 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kintegrityd/1                                                                                   
   22 root      20   0     0    0    0 S  0.0  0.0   0:00.53 kblockd/0                                                                                       
   23 root      20   0     0    0    0 S  0.0  0.0   0:00.37 kblockd/1                                                                                       
   24 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kacpid                                                                                          
   25 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kacpi_notify                                                                                    
   26 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kacpi_hotplug                                                                                   
   27 root      20   0     0    0    0 S  0.0  0.0   0:00.00 ata/0                                                                                           
   28 root      20   0     0    0    0 S  0.0  0.0   0:00.00 ata/1                                                                                           
   29 root      20   0     0    0    0 S  0.0  0.0   0:00.00 ata_aux                                                                                         
   30 root      20   0     0    0    0 S  0.0  0.0   0:00.00 ksuspend_usbd                                                                                   
   31 root      20   0     0    0    0 S  0.0  0.0   0:00.00 khubd                                                                                           
   32 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kseriod                                                                                         
   33 root      20   0     0    0    0 S  0.0  0.0   0:00.00 md/0                                                                                            
   34 root      20   0     0    0    0 S  0.0  0.0   0:00.00 md/1                                                                                            
   35 root      20   0     0    0    0 S  0.0  0.0   0:00.00 md_misc/0                                                                                       
   36 root      20   0     0    0    0 S  0.0  0.0   0:00.00 md_misc/1                                                                                       
   37 root      20   0     0    0    0 S  0.0  0.0   0:00.04 khungtaskd                                                                                      
   38 root      20   0     0    0    0 S  0.0  0.0   0:00.06 kswapd0                                                                                         
   39 root      25   5     0    0    0 S  0.0  0.0   0:00.00 ksmd                                                                                            
   40 root      39  19     0    0    0 S  0.0  0.0   0:00.24 khugepaged 

5000并发
top - 12:41:22 up 1 day, 18:08,  3 users,  load average: 0.54, 0.21, 0.06
Tasks: 107 total,   3 running, 104 sleeping,   0 stopped,   0 zombie
Cpu(s): 77.9%us, 14.6%sy,  0.0%ni,  1.0%id,  0.0%wa,  0.0%hi,  6.5%si,  0.0%st
Mem:   1922552k total,   814924k used,  1107628k free,    53964k buffers
Swap:  2096440k total,        0k used,  2096440k free,   478032k cached

  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND                                                                                         
21499 root      20   0  661m  62m 5492 R 100.1  3.3   0:55.93 node                                                                                           
21571 root      20   0  106m  37m 2072 R 97.8  2.0   0:07.79 ab                                                                                              
21505 root      20   0 95828 3876 2944 S  0.3  0.2   0:00.21 sshd                                                                                            
    1 root      20   0 19228 1476 1188 S  0.0  0.1   0:00.48 init                                                                                            
    2 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kthreadd                                                                                        
    3 root      RT   0     0    0    0 S  0.0  0.0   0:00.10 migration/0                                                                                     
    4 root      20   0     0    0    0 S  0.0  0.0   0:00.38 ksoftirqd/0                                                                                     
    5 root      RT   0     0    0    0 S  0.0  0.0   0:00.00 migration/0                                                                                     
    6 root      RT   0     0    0    0 S  0.0  0.0   0:00.49 watchdog/0                                                                                      
    7 root      RT   0     0    0    0 S  0.0  0.0   0:00.23 migration/1                                                                                     
    8 root      RT   0     0    0    0 S  0.0  0.0   0:00.00 migration/1                                                                                     
    9 root      20   0     0    0    0 S  0.0  0.0   0:01.81 ksoftirqd/1                                                                                     
   10 root      RT   0     0    0    0 S  0.0  0.0   0:00.42 watchdog/1                                                                                      
   11 root      20   0     0    0    0 S  0.0  0.0   0:11.54 events/0                                                                                        
   12 root      20   0     0    0    0 S  0.0  0.0   0:12.06 events/1                                                                                        
   13 root      20   0     0    0    0 S  0.0  0.0   0:00.00 cgroup                                                                                          
   14 root      20   0     0    0    0 S  0.0  0.0   0:00.00 khelper                                                                                         
   15 root      20   0     0    0    0 S  0.0  0.0   0:00.00 netns                                                                                           
   16 root      20   0     0    0    0 S  0.0  0.0   0:00.00 async/mgr                                                                                       
   17 root      20   0     0    0    0 S  0.0  0.0   0:00.00 pm                                                                                              
   18 root      20   0     0    0    0 S  0.0  0.0   0:00.78 sync_supers                                                                                     
   19 root      20   0     0    0    0 S  0.0  0.0   0:00.99 bdi-default                                                                                     
   20 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kintegrityd/0                                                                                   
   21 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kintegrityd/1                                                                                   
   22 root      20   0     0    0    0 S  0.0  0.0   0:00.53 kblockd/0                                                                                       
   23 root      20   0     0    0    0 S  0.0  0.0   0:00.37 kblockd/1                                                                                       
   24 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kacpid                                                                                          
   25 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kacpi_notify                                                                                    
   26 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kacpi_hotplug                                                                                   
   27 root      20   0     0    0    0 S  0.0  0.0   0:00.00 ata/0                                                                                           
   28 root      20   0     0    0    0 S  0.0  0.0   0:00.00 ata/1                                                                                           
   29 root      20   0     0    0    0 S  0.0  0.0   0:00.00 ata_aux                                                                                         
   30 root      20   0     0    0    0 S  0.0  0.0   0:00.00 ksuspend_usbd                                                                                   
   31 root      20   0     0    0    0 S  0.0  0.0   0:00.00 khubd                                                                                           
   32 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kseriod                                                                                         
   33 root      20   0     0    0    0 S  0.0  0.0   0:00.00 md/0                                                                                            
   34 root      20   0     0    0    0 S  0.0  0.0   0:00.00 md/1                                                                                            
   35 root      20   0     0    0    0 S  0.0  0.0   0:00.00 md_misc/0                                                                                       
   36 root      20   0     0    0    0 S  0.0  0.0   0:00.00 md_misc/1                                                                                       
   37 root      20   0     0    0    0 S  0.0  0.0   0:00.04 khungtaskd                                                                                      
   38 root      20   0     0    0    0 S  0.0  0.0   0:00.06 kswapd0                                                                                         
   39 root      25   5     0    0    0 S  0.0  0.0   0:00.00 ksmd      
   

连接数据库with no hiredis
npm install redis
npm install hiredis redis
ab -c 1000 -t 10 http://106.3.38.35:8080/

1000/10	1000/30	2000/10	2000/30	3000/30	5000/30
Rps	3068.98	3512.11	3628.58	3602.24	3579.87	3667.04
Tpq	0.326	0.285	0.276	0.278	0.279	0.273
fail	0	0	0	0	0	0

rps:代表每秒处理请求数，并发的主要指标 
tpq:每个请求处理的时间，单位毫秒。 
fail:代表平均处理失败请求数。

1000并发
top - 14:10:56 up 1 day, 19:38,  5 users,  load average: 0.11, 0.04, 0.01
Tasks: 114 total,   2 running, 112 sleeping,   0 stopped,   0 zombie
Cpu(s): 29.0%us, 11.1%sy,  0.0%ni, 54.5%id,  0.0%wa,  0.0%hi,  5.4%si,  0.0%st
Mem:   1922552k total,   828332k used,  1094220k free,    55684k buffers
Swap:  2096440k total,        0k used,  2096440k free,   534352k cached

  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND                                                                                         
23484 root      20   0  661m  59m 5884 R 64.8  3.2   0:10.83 node                                                                                            
23487 root      20   0 68240 9764 2072 S 21.9  0.5   0:00.66 ab                                                                                              
23429 root      20   0 40460 7608 1184 S  7.0  0.4   0:02.36 redis-server                                                                                    
21584 root      20   0 95828 3860 2944 S  0.3  0.2   0:00.20 sshd                                                                                            
21586 root      20   0  105m 1892 1520 S  0.3  0.1   0:00.10 bash                                                                                            
    1 root      20   0 19228 1476 1188 S  0.0  0.1   0:00.48 init                                                                                            
    2 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kthreadd                                                                                        
    3 root      RT   0     0    0    0 S  0.0  0.0   0:00.12 migration/0                                                                                     
    4 root      20   0     0    0    0 S  0.0  0.0   0:00.43 ksoftirqd/0                                                                                     
    5 root      RT   0     0    0    0 S  0.0  0.0   0:00.00 migration/0                                                                                     
    6 root      RT   0     0    0    0 S  0.0  0.0   0:00.51 watchdog/0                                                                                      
    7 root      RT   0     0    0    0 S  0.0  0.0   0:00.25 migration/1                                                                                     
    8 root      RT   0     0    0    0 S  0.0  0.0   0:00.00 migration/1                                                                                     
    9 root      20   0     0    0    0 S  0.0  0.0   0:01.84 ksoftirqd/1                                                                                     
   10 root      RT   0     0    0    0 S  0.0  0.0   0:00.43 watchdog/1                                                                                      
   11 root      20   0     0    0    0 S  0.0  0.0   0:12.00 events/0                                                                                        
   12 root      20   0     0    0    0 S  0.0  0.0   0:12.48 events/1                                                                                        
   13 root      20   0     0    0    0 S  0.0  0.0   0:00.00 cgroup                                                                                          
   14 root      20   0     0    0    0 S  0.0  0.0   0:00.00 khelper                                                                                         
   15 root      20   0     0    0    0 S  0.0  0.0   0:00.00 netns                                                                                           
   16 root      20   0     0    0    0 S  0.0  0.0   0:00.00 async/mgr                                                                                       
   17 root      20   0     0    0    0 S  0.0  0.0   0:00.00 pm                                                                                              
   18 root      20   0     0    0    0 S  0.0  0.0   0:00.81 sync_supers                                                                                     
   19 root      20   0     0    0    0 S  0.0  0.0   0:01.03 bdi-default                                                                                     
   20 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kintegrityd/0                                                                                   
   21 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kintegrityd/1                                                                                   
   22 root      20   0     0    0    0 S  0.0  0.0   0:00.54 kblockd/0                                                                                       
   23 root      20   0     0    0    0 S  0.0  0.0   0:00.39 kblockd/1                                                                                       
   24 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kacpid                                                                                          
   25 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kacpi_notify                                                                                    
   26 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kacpi_hotplug                                                                                   
   27 root      20   0     0    0    0 S  0.0  0.0   0:00.00 ata/0                                                                                           
   28 root      20   0     0    0    0 S  0.0  0.0   0:00.00 ata/1                                                                                           
   29 root      20   0     0    0    0 S  0.0  0.0   0:00.00 ata_aux                                                                                         
   30 root      20   0     0    0    0 S  0.0  0.0   0:00.00 ksuspend_usbd                                                                                   
   31 root      20   0     0    0    0 S  0.0  0.0   0:00.00 khubd                                                                                           
   32 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kseriod                                                                                         
   33 root      20   0     0    0    0 S  0.0  0.0   0:00.00 md/0                                                                                            
   34 root      20   0     0    0    0 S  0.0  0.0   0:00.00 md/1                                                                                            
   35 root      20   0     0    0    0 S  0.0  0.0   0:00.00 md_misc/0                                                                                       
   36 root      20   0     0    0    0 S  0.0  0.0   0:00.00 md_misc/1                                                                                       
   37 root      20   0     0    0    0 S  0.0  0.0   0:00.05 khungtaskd  
   
top - 14:15:15 up 1 day, 19:42,  5 users,  load average: 0.11, 0.06, 0.01
Tasks: 114 total,   2 running, 112 sleeping,   0 stopped,   0 zombie
Cpu(s): 44.4%us, 13.5%sy,  0.0%ni, 35.7%id,  0.0%wa,  0.0%hi,  6.3%si,  0.0%st
Mem:   1922552k total,   848504k used,  1074048k free,    55732k buffers
Swap:  2096440k total,        0k used,  2096440k free,   534352k cached

  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND                                                                                         
23484 root      20   0  661m  60m 5884 R 89.1  3.2   0:40.52 node                                                                                            
23495 root      20   0 78528  16m 2072 S 31.6  0.9   0:01.43 ab                                                                                              
23429 root      20   0 40460 7608 1184 S  9.0  0.4   0:08.37 redis-server                                                                                    
    4 root      20   0     0    0    0 S  0.7  0.0   0:00.48 ksoftirqd/0                                                                                     
    1 root      20   0 19228 1476 1188 S  0.0  0.1   0:00.48 init                                                                                            
    2 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kthreadd                                                                                        
    3 root      RT   0     0    0    0 S  0.0  0.0   0:00.12 migration/0                                                                                     
    5 root      RT   0     0    0    0 S  0.0  0.0   0:00.00 migration/0                                                                                     
    6 root      RT   0     0    0    0 S  0.0  0.0   0:00.51 watchdog/0                                                                                      
    7 root      RT   0     0    0    0 S  0.0  0.0   0:00.25 migration/1                                                                                     
    8 root      RT   0     0    0    0 S  0.0  0.0   0:00.00 migration/1                                                                                     
    9 root      20   0     0    0    0 S  0.0  0.0   0:01.84 ksoftirqd/1                                                                                     
   10 root      RT   0     0    0    0 S  0.0  0.0   0:00.43 watchdog/1                                                                                      
   11 root      20   0     0    0    0 S  0.0  0.0   0:12.04 events/0                                                                                        
   12 root      20   0     0    0    0 S  0.0  0.0   0:12.50 events/1                                                                                        
   13 root      20   0     0    0    0 S  0.0  0.0   0:00.00 cgroup                                                                                          
   14 root      20   0     0    0    0 S  0.0  0.0   0:00.00 khelper                                                                                         
   15 root      20   0     0    0    0 S  0.0  0.0   0:00.00 netns                                                                                           
   16 root      20   0     0    0    0 S  0.0  0.0   0:00.00 async/mgr                                                                                       
   17 root      20   0     0    0    0 S  0.0  0.0   0:00.00 pm                                                                                              
   18 root      20   0     0    0    0 S  0.0  0.0   0:00.81 sync_supers                                                                                     
   19 root      20   0     0    0    0 S  0.0  0.0   0:01.03 bdi-default                                                                                     
   20 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kintegrityd/0                                                                                   
   21 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kintegrityd/1                                                                                   
   22 root      20   0     0    0    0 S  0.0  0.0   0:00.54 kblockd/0                                                                                       
   23 root      20   0     0    0    0 S  0.0  0.0   0:00.39 kblockd/1                                                                                       
   24 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kacpid                                                                                          
   25 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kacpi_notify                                                                                    
   26 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kacpi_hotplug                                                                                   
   27 root      20   0     0    0    0 S  0.0  0.0   0:00.00 ata/0                                                                                           
   28 root      20   0     0    0    0 S  0.0  0.0   0:00.00 ata/1                                                                                           
   29 root      20   0     0    0    0 S  0.0  0.0   0:00.00 ata_aux                                                                                         
   30 root      20   0     0    0    0 S  0.0  0.0   0:00.00 ksuspend_usbd                                                                                   
   31 root      20   0     0    0    0 S  0.0  0.0   0:00.00 khubd                                                                                           
   32 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kseriod                                                                                         
   33 root      20   0     0    0    0 S  0.0  0.0   0:00.00 md/0                                                                                            
   34 root      20   0     0    0    0 S  0.0  0.0   0:00.00 md/1                                                                                            
   35 root      20   0     0    0    0 S  0.0  0.0   0:00.00 md_misc/0                                                                                       
   36 root      20   0     0    0    0 S  0.0  0.0   0:00.00 md_misc/1                                                                                       
   37 root      20   0     0    0    0 S  0.0  0.0   0:00.05 khungtaskd                                                                                      
   38 root      20   0     0    0    0 S  0.0  0.0   0:00.06 kswapd0                                                                                         
   39 root      25   5     0    0    0 S  0.0  0.0   0:00.00 ksmd       

top - 14:16:15 up 1 day, 19:43,  5 users,  load average: 0.47, 0.16, 0.04
Tasks: 114 total,   2 running, 112 sleeping,   0 stopped,   0 zombie
Cpu(s): 50.8%us, 14.5%sy,  0.0%ni, 28.5%id,  0.0%wa,  0.0%hi,  6.2%si,  0.0%st
Mem:   1922552k total,   863052k used,  1059500k free,    55740k buffers
Swap:  2096440k total,        0k used,  2096440k free,   534352k cached

  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND                                                                                         
23484 root      20   0  662m  61m 5884 R 91.8  3.3   0:58.73 node                                                                                            
23498 root      20   0 88824  23m 2072 S 41.6  1.3   0:03.48 ab                                                                                              
23429 root      20   0 40460 7608 1184 S 15.3  0.4   0:10.76 redis-server                                                                                    
    9 root      20   0     0    0    0 S  0.3  0.0   0:01.86 ksoftirqd/1                                                                                     
    1 root      20   0 19228 1476 1188 S  0.0  0.1   0:00.48 init                                                                                            
    2 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kthreadd                                                                                        
    3 root      RT   0     0    0    0 S  0.0  0.0   0:00.12 migration/0                                                                                     
    4 root      20   0     0    0    0 S  0.0  0.0   0:00.50 ksoftirqd/0                                                                                     
    5 root      RT   0     0    0    0 S  0.0  0.0   0:00.00 migration/0                                                                                     
    6 root      RT   0     0    0    0 S  0.0  0.0   0:00.51 watchdog/0                                                                                      
    7 root      RT   0     0    0    0 S  0.0  0.0   0:00.25 migration/1                                                                                     
    8 root      RT   0     0    0    0 S  0.0  0.0   0:00.00 migration/1                                                                                     
   10 root      RT   0     0    0    0 S  0.0  0.0   0:00.43 watchdog/1                                                                                      
   11 root      20   0     0    0    0 S  0.0  0.0   0:12.05 events/0                                                                                        
   12 root      20   0     0    0    0 S  0.0  0.0   0:12.50 events/1                                                                                        
   13 root      20   0     0    0    0 S  0.0  0.0   0:00.00 cgroup                                                                                          
   14 root      20   0     0    0    0 S  0.0  0.0   0:00.00 khelper                                                                                         
   15 root      20   0     0    0    0 S  0.0  0.0   0:00.00 netns                                                                                           
   16 root      20   0     0    0    0 S  0.0  0.0   0:00.00 async/mgr                                                                                       
   17 root      20   0     0    0    0 S  0.0  0.0   0:00.00 pm                                                                                              
   18 root      20   0     0    0    0 S  0.0  0.0   0:00.81 sync_supers                                                                                     
   19 root      20   0     0    0    0 S  0.0  0.0   0:01.03 bdi-default                                                                                     
   20 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kintegrityd/0                                                                                   
   21 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kintegrityd/1                                                                                   
   22 root      20   0     0    0    0 S  0.0  0.0   0:00.54 kblockd/0                                                                                       
   23 root      20   0     0    0    0 S  0.0  0.0   0:00.39 kblockd/1                                                                                       
   24 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kacpid                                                                                          
   25 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kacpi_notify                                                                                    
   26 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kacpi_hotplug                                                                                   
   27 root      20   0     0    0    0 S  0.0  0.0   0:00.00 ata/0                                                                                           
   28 root      20   0     0    0    0 S  0.0  0.0   0:00.00 ata/1                                                                                           
   29 root      20   0     0    0    0 S  0.0  0.0   0:00.00 ata_aux                                                                                         
   30 root      20   0     0    0    0 S  0.0  0.0   0:00.00 ksuspend_usbd                                                                                   
   31 root      20   0     0    0    0 S  0.0  0.0   0:00.00 khubd                                                                                           
   32 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kseriod                                                                                         
   33 root      20   0     0    0    0 S  0.0  0.0   0:00.00 md/0                                                                                            
   34 root      20   0     0    0    0 S  0.0  0.0   0:00.00 md/1                                                                                            
   35 root      20   0     0    0    0 S  0.0  0.0   0:00.00 md_misc/0                                                                                       
   36 root      20   0     0    0    0 S  0.0  0.0   0:00.00 md_misc/1                                                                                       
   37 root      20   0     0    0    0 S  0.0  0.0   0:00.05 khungtaskd                                                                                      
   38 root      20   0     0    0    0 S  0.0  0.0   0:00.06 kswapd0                                                                                         
   39 root      25   5     0    0    0 S  0.0  0.0   0:00.00 ksmd      
   
top - 14:18:06 up 1 day, 19:45,  5 users,  load average: 0.60, 0.24, 0.08
Tasks: 114 total,   3 running, 111 sleeping,   0 stopped,   0 zombie
Cpu(s): 72.4%us, 14.9%sy,  0.0%ni,  6.0%id,  0.0%wa,  0.0%hi,  6.7%si,  0.0%st
Mem:   1922552k total,   892392k used,  1030160k free,    55756k buffers
Swap:  2096440k total,        0k used,  2096440k free,   534352k cached

  PID USER      PR  NI  VIRT  RES  SHR S %CPU %MEM    TIME+  COMMAND                                                                                         
23484 root      20   0  666m  66m 5884 R 92.8  3.5   1:17.06 node                                                                                            
23501 root      20   0  106m  37m 2072 R 86.5  2.0   0:08.34 ab                                                                                              
23429 root      20   0 40460 7608 1184 S  8.6  0.4   0:12.69 redis-server                                                                                    
    1 root      20   0 19228 1476 1188 S  0.0  0.1   0:00.48 init                                                                                            
    2 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kthreadd                                                                                        
    3 root      RT   0     0    0    0 S  0.0  0.0   0:00.12 migration/0                                                                                     
    4 root      20   0     0    0    0 S  0.0  0.0   0:00.52 ksoftirqd/0                                                                                     
    5 root      RT   0     0    0    0 S  0.0  0.0   0:00.00 migration/0                                                                                     
    6 root      RT   0     0    0    0 S  0.0  0.0   0:00.51 watchdog/0                                                                                      
    7 root      RT   0     0    0    0 S  0.0  0.0   0:00.25 migration/1                                                                                     
    8 root      RT   0     0    0    0 S  0.0  0.0   0:00.00 migration/1                                                                                     
    9 root      20   0     0    0    0 S  0.0  0.0   0:01.86 ksoftirqd/1                                                                                     
   10 root      RT   0     0    0    0 S  0.0  0.0   0:00.43 watchdog/1                                                                                      
   11 root      20   0     0    0    0 S  0.0  0.0   0:12.07 events/0                                                                                        
   12 root      20   0     0    0    0 S  0.0  0.0   0:12.51 events/1                                                                                        
   13 root      20   0     0    0    0 S  0.0  0.0   0:00.00 cgroup                                                                                          
   14 root      20   0     0    0    0 S  0.0  0.0   0:00.00 khelper                                                                                         
   15 root      20   0     0    0    0 S  0.0  0.0   0:00.00 netns                                                                                           
   16 root      20   0     0    0    0 S  0.0  0.0   0:00.00 async/mgr                                                                                       
   17 root      20   0     0    0    0 S  0.0  0.0   0:00.00 pm                                                                                              
   18 root      20   0     0    0    0 S  0.0  0.0   0:00.81 sync_supers                                                                                     
   19 root      20   0     0    0    0 S  0.0  0.0   0:01.03 bdi-default                                                                                     
   20 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kintegrityd/0                                                                                   
   21 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kintegrityd/1                                                                                   
   22 root      20   0     0    0    0 S  0.0  0.0   0:00.54 kblockd/0                                                                                       
   23 root      20   0     0    0    0 S  0.0  0.0   0:00.39 kblockd/1                                                                                       
   24 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kacpid                                                                                          
   25 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kacpi_notify                                                                                    
   26 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kacpi_hotplug                                                                                   
   27 root      20   0     0    0    0 S  0.0  0.0   0:00.00 ata/0                                                                                           
   28 root      20   0     0    0    0 S  0.0  0.0   0:00.00 ata/1                                                                                           
   29 root      20   0     0    0    0 S  0.0  0.0   0:00.00 ata_aux                                                                                         
   30 root      20   0     0    0    0 S  0.0  0.0   0:00.00 ksuspend_usbd                                                                                   
   31 root      20   0     0    0    0 S  0.0  0.0   0:00.00 khubd                                                                                           
   32 root      20   0     0    0    0 S  0.0  0.0   0:00.00 kseriod                                                                                         
   33 root      20   0     0    0    0 S  0.0  0.0   0:00.00 md/0                                                                                            
   34 root      20   0     0    0    0 S  0.0  0.0   0:00.00 md/1                                                                                            
   35 root      20   0     0    0    0 S  0.0  0.0   0:00.00 md_misc/0                                                                                       
   36 root      20   0     0    0    0 S  0.0  0.0   0:00.00 md_misc/1                                                                                       
   37 root      20   0     0    0    0 S  0.0  0.0   0:00.05 khungtaskd                                                                                      
   38 root      20   0     0    0    0 S  0.0  0.0   0:00.06 kswapd0                                                                                         
   39 root      25   5     0    0    0 S  0.0  0.0   0:00.00 ksmd  

This is ApacheBench, Version 2.3 <$Revision: 655654 $>
Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/
Licensed to The Apache Software Foundation, http://www.apache.org/

Benchmarking 106.3.38.35 (be patient)
Completed 5000 requests
Completed 10000 requests
Completed 15000 requests
Completed 20000 requests
Completed 25000 requests
Completed 30000 requests
Completed 35000 requests
Completed 40000 requests
Completed 45000 requests
Completed 50000 requests
Finished 50000 requests


Server Software:        
Server Hostname:        106.3.38.35
Server Port:            8080

Document Path:          /
Document Length:        0 bytes

Concurrency Level:      3000
Time taken for tests:   13.967 seconds
Complete requests:      50000
Failed requests:        50000
   (Connect: 0, Receive: 0, Length: 49864, Exceptions: 136)
Write errors:           0
Total transferred:      5584768 bytes
HTML transferred:       548504 bytes
Requests per second:    3579.87 [#/sec] (mean)
Time per request:       838.019 [ms] (mean)
Time per request:       0.279 [ms] (mean, across all concurrent requests)
Transfer rate:          390.48 [Kbytes/sec] received

Connection Times (ms)
              min  mean[+/-sd] median   max
Connect:        0  320 1051.9      2    7009
Processing:     7  123 136.2    104    6630
Waiting:        0  122 136.2    103    6629
Total:         26  443 1077.7    110    7838

Percentage of the requests served within a certain time (ms)
  50%    110
  66%    121
  75%    137
  80%    164
  90%   1102
  95%   3098
  98%   3356
  99%   7111
 100%   7838 (longest request)   
 
2013-09-14
ab -n 1000 -c 100 http://192.168.1.22:8080/
cat /proc/sys/fs/file-max 199122

This is ApacheBench, Version 2.3 <$Revision: 655654 $>
Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/
Licensed to The Apache Software Foundation, http://www.apache.org/

Benchmarking 192.168.1.22 (be patient)
Completed 100 requests
Completed 200 requests
Completed 300 requests
Completed 400 requests
Completed 500 requests
Completed 600 requests
Completed 700 requests
Completed 800 requests
Completed 900 requests
Completed 1000 requests
Finished 1000 requests


Server Software:        
Server Hostname:        192.168.1.22
Server Port:            8080

Document Path:          /
Document Length:        11 bytes

Concurrency Level:      100
Time taken for tests:   0.517 seconds
Complete requests:      1000
Failed requests:        0
Write errors:           0
Total transferred:      112000 bytes
HTML transferred:       11000 bytes
Requests per second:    1933.26 [#/sec] (mean)
Time per request:       51.726 [ms] (mean)
Time per request:       0.517 [ms] (mean, across all concurrent requests)
Transfer rate:          211.45 [Kbytes/sec] received

Connection Times (ms)
              min  mean[+/-sd] median   max
Connect:        0    0   1.0      0       5
Processing:    26   50   6.8     49     101
Waiting:       26   50   6.8     49     101
Total:         26   50   6.3     49     103

Percentage of the requests served within a certain time (ms)
  50%     49
  66%     50
  75%     52
  80%     52
  90%     60
  95%     60
  98%     61
  99%     61
 100%    103 (longest request)
 
程序更新后，192.168.1.22测试结果，1000的请求100的并发
1000/100
Rps	1933.26
Tpq	0.517
fail 0